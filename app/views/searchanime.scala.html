@import helper._

@*RequestHeader needed for form with CRSF*@
@(animeResults: Seq[AnimeModel], pagination: AnimeSearchPagination, search: String, queryExt: String)(implicit request: RequestHeader)
@main("Search Anime"){
  <h1>Jikan API</h1>

  <p><a href="@routes.HomeController.index()"> Back </a></p>

  <h2>Search results</h2>

  @if(animeResults.isEmpty) {
    <p>No search results.</p>
  } else {
    <div>
      <p>
        @if(pagination.current_page > 1){ <a href="@routes.ApplicationController.getAnimeResults(search, pagination.current_page - 1, queryExt)"> Previous </a> - }
        <b>Page @pagination.current_page of @pagination.last_visible_page</b>
        @if(pagination.has_next_page){ - <a href="@routes.ApplicationController.getAnimeResults(search, pagination.current_page + 1, queryExt)"> Next </a> }
      </p>
      <p>Results @{(pagination.current_page-1) * pagination.items.per_page + 1}-@{(pagination.current_page-1) * pagination.items.per_page + pagination.items.count}
        of @pagination.items.total</p>
    </div>

    <ul>
    @for(anime <- animeResults) {
      <li>
        <p><b>@anime.title</b>
          @if(anime.titleEnglish.nonEmpty){ <br><i>@anime.titleEnglish</i> }
        </p>
        <p>@{anime.`type`}, @anime.year.getOrElse("Year not available")</p>
        <p>@if(anime.numEpisodes.nonEmpty){
          Episodes: @anime.numEpisodes
        } else {
          No. of episodes unknown
        }
        </p>
        <p>Status: @anime.status</p>
        @if(anime.avgScore.nonEmpty){
          <p>Average score: @anime.avgScore from @anime.scoredBy reviews</p>
        }
      </li>
@*      <form action="@routes.ApplicationController.addFromSearch()" method="POST" class="button-form">*@
@*        @CSRF.formField*@
@*      <input type="hidden" name="_id" value="@book._id" required>*@
@*      <input type="hidden" name="name" value="@book.name" required>*@
@*      <input type="hidden" name="description" value="@book.description">*@
@*      <input type="hidden" name="pageCount" value="@book.pageCount" required>*@
@*      <button type="submit">Add to database</button>*@
@*      </form>*@
    }
    </ul>
  }
}